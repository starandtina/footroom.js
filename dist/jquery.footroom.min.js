/*! footroom - v0.0.1 - 2016-01-20
* Copyright (c) 2016 Zhang Xin; Licensed MIT */
!function(a){function b(c,d){d=_.defaults(d,b.options),this.lastKnownScrollY=0,this.elem=c,this.$elem=a(c),this.classes=d.classes,this.tolerance=d.tolerance,this.scroller=d.scroller,this.offset=d.offset,this.initialized=!1,this.onPin=d.onPin,this.onUnpin=d.onUnpin}b.prototype={constructor:b,init:function(){_.defer(_.bind(this.attachEvent,this),100)},destroy:function(){this.initialized=!1;var b=this.classes;this.$elem.removeClass([b.unpinned,b.pinned,b.top,b.initial].join(" ")),a(this.scroller).off("scroll.footroom")},attachEvent:function(){this.initialized||(this.lastKnownScrollY=this.getScrollY(),this.initialized=!0,a(this.scroller).on("scroll.footroom",_.throttle(_.bind(this.update,this),250)))},pin:function(){var a=this.classes;this.$elem.hasClass(a.unpinned)&&(this.$elem.addClass(a.pinned),this.$elem.removeClass(a.unpinned),this.onPin&&this.onPin.call(this))},unpin:function(){var a=this.classes;(this.$elem.hasClass(a.pinned)||!this.$elem.hasClass(a.unpinned))&&(this.$elem.addClass(a.unpinned),this.$elem.removeClass(a.pinned),this.onUnpin&&this.onUnpin.call(this))},bottom:function(){var a=this.classes;this.$elem.hasClass(a.bottom)||(this.$elem.addClass(a.bottom),this.$elem.removeClass(a.noBottom))},noBottom:function(){var a=this.classes;this.$elem.hasClass(a.noBottom)||(this.$elem.removeClass(a.bottom),this.$elem.addClass(a.noBottom))},getScrollY:function(){return void 0!==this.scroller.pageYOffset?this.scroller.pageYOffset:void 0!==this.scroller.scrollTop?this.scroller.scrollTop:(document.documentElement||document.body.parentNode||document.body).scrollTop},getViewportHeight:function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},getDocumentHeight:function(){var a=document.body,b=document.documentElement;return Math.max(a.scrollHeight,b.scrollHeight,a.offsetHeight,b.offsetHeight,a.clientHeight,b.clientHeight)},getElementHeight:function(a){return Math.max(a.scrollHeight,a.offsetHeight,a.clientHeight)},getScrollerHeight:function(){return this.scroller===window||this.scroller===document.body?this.getDocumentHeight():this.getElementHeight(this.scroller)},toleranceExceeded:function(a,b){return Math.abs(a-this.lastKnownScrollY)>=this.tolerance[b]},isOutOfBounds:function(a){var b=0>a,c=a+this.getViewportHeight()>this.getScrollerHeight();return b||c},shouldPin:function(a,b){var c=a<this.lastKnownScrollY,d=a+this.getViewportHeight()+this.offset<this.getScrollerHeight();return c&&b||d},shouldUnpin:function(a,b){var c=a>this.lastKnownScrollY,d=a+this.getViewportHeight()+this.offset>=this.getScrollerHeight();return c&&b&&d},update:function(){var a=this.getScrollY(),b=a>this.lastKnownScrollY?"down":"up",c=this.toleranceExceeded(a,b);this.isOutOfBounds(a)||(a+this.getViewportHeight()>=this.getScrollerHeight()?this.bottom():this.noBottom(),this.shouldUnpin(a,c)?this.unpin():this.shouldPin(a,c)&&this.pin(),this.lastKnownScrollY=a)}},b.options={tolerance:{up:0,down:0},offset:0,scroller:window,classes:{pinned:"footroom--pinned",unpinned:"footroom--unpinned",bottom:"footroom--bottom",noBottom:"footroom--not-bottom",initial:"footroom"}},a.fn.footroom=function(c){return this.each(function(){var d=a(this),e=d.data("footroom"),f="object"==typeof c&&c;f=a.extend(!0,{},b.options,f),e||(e=new b(this,f),e.init(),d.data("footroom",e)),"string"==typeof c&&e[c]()})},a("[data-footroom]").each(function(){var b=a(this);b.footroom(b.data())})}(jQuery);